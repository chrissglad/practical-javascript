<!DOCTYPE html>

<html>
  <head>
    <title>Practical JavaScript</title>
  </head>

  <body>
    <script>
      var func = "function";

      // check storage support
      var storageSupport =
        !!localStorage &&
        typeof localStorage.getItem === func &&
        typeof localStorage.setItem === func &&
        typeof localStorage.removeItem === func;

      //show items
      console.log(getTodos());

      // get todos
      function getTodos() {
        var todos;
        var lsItems = localStorage.getItem("todos");
        if (lsItems === null) {
          todos = [];
        } else {
          todos = JSON.parse(lsItems);
        }
        return todos;
      }

      //add item
      function addTodo(todo) {
        if (storageSupport) {
          var todos = getTodos();
          todos.push(todo);
          console.log(todos);
          return saveTodosInLocalStorage(todos);
        }
      }

      //edit item
      function editTodo(position, newValue) {
        if (storageSupport) {
          var todos = getTodos();
          todos[position] = newValue;
          console.log(todos);
          return saveTodosInLocalStorage(todos);
        }
      }

      //remove item
      function removeTodo(position) {
        if (storageSupport) {
          var todos = getTodos();
          todos.splice(position, 1);
          console.log(todos);
          return saveTodosInLocalStorage(todos);
        }
      }

      // clear items
      function clearTodos() {
        if (storageSupport) {
          if (localStorage.getItem("todos") !== null)
            return localStorage.removeItem("todos");
        }
      }

      // save todos to localstorage
      function saveTodosInLocalStorage(todos) {
        window.localStorage.setItem("todos", JSON.stringify(todos));
      }
    </script>
  </body>
</html>
